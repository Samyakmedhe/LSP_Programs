//          ./cpx       Source.txt      Dest.txt
//          argv[0]     argv[1]         argv[2]
//          argc = 3

/*
    Step 1 : 
        Open Source file for reading
    
    Step 2 :
        Create Destination File
    
    Step 3 :
        Read the data from source 

    Step 4 :
        Write it into destination
    
    Step 5 :
        close both files

*/


#include<stdio.h>
#include<unistd.h>
#include<string.h>
#include<fcntl.h>

# define MAX_BUFFER_SIZE 1024

int main(int argc , char * argv[])
{
    if(argc != 3)
    {
        printf("ERROR : Insufficient Arguments\n");
        printf("Use command as :    ./cpx   SourceFileName  DestinationFileName\n");

        return 1;
    }

    int fdSrc = 0 , fdDest = 0 , iRet = 0;
    
    char Buffer [MAX_BUFFER_SIZE] = {'\0'};

    memset(Buffer , '\0', sizeof(Buffer));

    fdSrc = open(argv[1], O_RDONLY);

    if(fdSrc < 0)
    {
        printf("ERROR : Unable to open source file : %s\n",argv[1]);
        return -1;
    }

    fdDest = creat(argv[2], 0777);

    if(fdDest < 0)
    {
        printf("ERROR : Unable to create destination file : %s\n",argv[2]);
        close(fdSrc);

        return -1;
    }

    while((iRet = read(fdSrc , Buffer , sizeof(Buffer))) != 0 )
    {
        write(fdDest , Buffer , iRet);
        memset(Buffer , '\0', sizeof(Buffer));
    }

    printf("Success : Copy Activity done\n");

    close(fdSrc);
    close(fdDest);

    return 0;
}